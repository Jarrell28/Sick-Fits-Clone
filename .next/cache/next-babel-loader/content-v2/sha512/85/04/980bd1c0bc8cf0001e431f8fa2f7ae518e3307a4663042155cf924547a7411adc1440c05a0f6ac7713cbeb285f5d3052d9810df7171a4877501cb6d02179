{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport gql from \"graphql-tag\";\nimport DisplayError from '../components/ErrorMessage';\nimport OrderItemStyles from '../components/styles/OrderItemStyles';\nimport Head from 'next/head';\nimport formatMoney from '../lib/formatMoney';\nimport { useQuery } from \"@apollo/client\";\nimport styled from \"styled-components\";\nimport Link from 'next/link'; //Query to receive all Orders\n\nconst USERS_ORDERS_QUERY = gql`\n    query USERS_ORDERS_QUERY{\n        allOrders {\n            id\n            charge\n            total\n            user {\n                id\n            }\n            items {\n                id\n                name\n                description\n                price\n                quantity\n                photo {\n                    image {\n                        publicUrlTransformed\n                    }\n                }\n            }\n        }\n    }\n`;\nconst OrderUl = styled.ul.withConfig({\n  displayName: \"orders__OrderUl\",\n  componentId: \"sc-15udvsj-0\"\n})([\"display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));grid-gap:4rem;\"]); //Quick function to display number of Items purchased\n\nfunction countItemsInAnOrder(order) {\n  return order.items.reduce((tally, item) => tally + item.quantity, 0);\n} //Component displaying all orders\n\n\nexport default function OrdersPage() {\n  const {\n    data,\n    error,\n    loading\n  } = useQuery(USERS_ORDERS_QUERY); //Loading and Error state\n\n  if (loading) return /*#__PURE__*/_jsx(\"p\", {\n    children: \"Loading...\"\n  });\n  if (error) return /*#__PURE__*/_jsx(DisplayError, {\n    error: error\n  });\n  const {\n    allOrders\n  } = data;\n  return /*#__PURE__*/_jsxs(\"div\", {\n    children: [/*#__PURE__*/_jsx(Head, {\n      children: /*#__PURE__*/_jsxs(\"title\", {\n        children: [\"Your Orders (\", allOrders.length, \")\"]\n      })\n    }), /*#__PURE__*/_jsxs(\"h2\", {\n      children: [\"You have \", allOrders.length, \" orders!\"]\n    }), /*#__PURE__*/_jsx(OrderUl, {\n      children: allOrders.map(order => /*#__PURE__*/_jsx(OrderItemStyles, {\n        children: /*#__PURE__*/_jsx(Link, {\n          href: `/order/${order.id}`,\n          children: /*#__PURE__*/_jsxs(\"a\", {\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              className: \"order-meta\",\n              children: [/*#__PURE__*/_jsxs(\"p\", {\n                children: [countItemsInAnOrder(order), \" Items\"]\n              }), /*#__PURE__*/_jsxs(\"p\", {\n                children: [order.items.length, \" Product\", order.items.length === 1 ? '' : 's']\n              }), /*#__PURE__*/_jsx(\"p\", {\n                children: formatMoney(order.total)\n              })]\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"images\",\n              children: order.items.map(item => {\n                var _item$photo, _item$photo$image;\n\n                return /*#__PURE__*/_jsx(\"img\", {\n                  src: (_item$photo = item.photo) === null || _item$photo === void 0 ? void 0 : (_item$photo$image = _item$photo.image) === null || _item$photo$image === void 0 ? void 0 : _item$photo$image.publicUrlTransformed,\n                  alt: item.name\n                }, item.id);\n              })\n            })]\n          })\n        })\n      }))\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}